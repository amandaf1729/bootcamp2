import urllib
import requests
import time

US_woeid = "23424977"
url = "https://www.metaweather.com/api/location/"
US_url = url + US_woeid
data = requests.get(US_url).json()

# Resulting cities_by_region dict from weather.py
cities_by_region = {'New England': [{'city': 'Bridgeport', 'woeid': 2368947}, {'city': 'Portland', 'woeid': 2475688}, {'city': 'Boston', 'woeid': 2367105}, {'city': 'Manchester', 'woeid': 2444674}, {'city': 'Providence', 'woeid': 2477058}, {'city': 'Burlington', 'woeid': 2372071}], 'Middle Atlantic': [{'city': 'Wilmington', 'woeid': 2521358}, {'city': 'Baltimore', 'woeid': 2358820}, {'city': 'Newark', 'woeid': 2459269}, {'city': 'New York', 'woeid': 2459115}, {'city': 'Philadelphia', 'woeid': 2471217}], 'South': [{'city': 'Birmingham', 'woeid': 2364559}, {'city': 'Little Rock', 'woeid': 2440351}, {'city': 'Jacksonville', 'woeid': 2428344}, {'city': 'Miami', 'woeid': 2450022}, {'city': 'Atlanta', 'woeid': 2357024}, {'city': 'Louisville', 'woeid': 2442327}, {'city': 'New Orleans', 'woeid': 2458833}, {'city': 'Jackson', 'woeid': 2428184}, {'city': 'Kansas City', 'woeid': 2430683}, {'city': 'St. Louis', 'woeid': 2486982}, {'city': 'Charlotte', 'woeid': 2378426}, {'city': 'Raleigh', 'woeid': 2478307}, {'city': 'Columbia', 'woeid': 2383552}, {'city': 'Memphis', 'woeid': 2449323}, {'city': 'Nashville', 'woeid': 2457170}, {'city': 'Richmond', 'woeid': 2480894}, {'city': 'Virginia Beach', 'woeid': 2512636}, {'city': 'Charleston', 'woeid': 2378319}], 'Midwest': [{'city': 'Chicago', 'woeid': 2379574}, {'city': 'Indianapolis', 'woeid': 2427032}, {'city': 'Des Moines', 'woeid': 2391446}, {'city': 'Wichita', 'woeid': 2520077}, {'city': 'Detroit', 'woeid': 2391585}, {'city': 'Minneapolis', 'woeid': 2452078}, {'city': 'Omaha', 'woeid': 2465512}, {'city': 'Fargo', 'woeid': 2402292}, {'city': 'Columbus', 'woeid': 2383660}, {'city': 'Milwaukee', 'woeid': 2451822}], 'South West': [{'city': 'Mesa', 'woeid': 2449808}, {'city': 'Phoenix', 'woeid': 2471390}, {'city': 'Tucson', 'woeid': 2508428}, {'city': 'Albuquerque', 'woeid': 2352824}, {'city': 'Santa Fe', 'woeid': 2488867}, {'city': 'Oklahoma City', 'woeid': 2464592}, {'city': 'Austin', 'woeid': 2357536}, {'city': 'Dallas', 'woeid': 2388929}, {'city': 'El Paso', 'woeid': 2397816}, {'city': 'Fort Worth', 'woeid': 2406080}, {'city': 'Houston', 'woeid': 2424766}, {'city': 'San Antonio', 'woeid': 2487796}], 'West': [{'city': 'Anchorage', 'woeid': 2354490}, {'city': 'Bakersfield', 'woeid': 2358492}, {'city': 'Fresno', 'woeid': 2407517}, {'city': 'Lake Tahoe', 'woeid': 23511744}, {'city': 'Long Beach', 'woeid': 2441472}, {'city': 'Los Angeles', 'woeid': 2442047}, {'city': 'Mountain View', 'woeid': 2455920}, {'city': 'Oakland', 'woeid': 2463583}, {'city': 'Palm Springs', 'woeid': 2467696}, {'city': 'Sacramento', 'woeid': 2486340}, {'city': 'San Diego', 'woeid': 2487889}, {'city': 'San Francisco', 'woeid': 2487956}, {'city': 'San Jose', 'woeid': 2488042}, {'city': 'Santa Cruz', 'woeid': 2488853}, {'city': 'Boulder', 'woeid': 2367231}, {'city': 'Colorado Springs', 'woeid': 2383489}, {'city': 'Denver', 'woeid': 2391279}, {'city': 'Honolulu', 'woeid': 2423945}, {'city': 'Boise', 'woeid': 2366355}, {'city': 'Billings', 'woeid': 2364254}, {'city': 'Las Vegas', 'woeid': 2436704}, {'city': 'Portland', 'woeid': 2475687}, {'city': 'Salt Lake City', 'woeid': 2487610}, {'city': 'Seattle', 'woeid': 2490383}, {'city': 'Cheyenne', 'woeid': 2379552}]}

# For each of the cities, store the temp, humidity, wind speed, and region
weather_data = {'Temperature' : [], 'Humidity' : [], 'Wind Speed' : [], 'Region' : []}
for region, cities in cities_by_region.items():
    for city in cities:
        id = city.get('woeid')
        weather = requests.get(url + str(id)).json().get('consolidated_weather')[0]
        weather_data.get('Temperature').append(weather.get('the_temp'))
        weather_data.get('Humidity').append(weather.get('humidity'))
        weather_data.get('Wind Speed').append(weather.get('wind_speed'))
        weather_data.get('Region').append(region)
print (weather_data)

# Resulting weather_data so that we dont have to call the API again in clustering.py
weather = {'Temperature': [7.74, 9.25, 4.55, 0.94, 7.715, 10.04, 21.825, 25.025, 12.985, 12.690000000000001, 22.51, 20.564999999999998, 26.545, 23.165, 26.29, 23.27, 21.82, 23.71, 25.41, 21.625, 22.63, 25.515, 20.805, 23.17, 25.4, 24.705, 16.8, 22.994999999999997, 22.57, 14.135, 18.055,
16.205, 21.055, 15.315, 11.39, 18.85, 2.645, 20.119999999999997, 12.68, 26.13, 29.1, 31.525, 20.135, 16.39, 28.35, 22.71, 28.405, 26.365000000000002, 28.845, 30.11, 22.795, 9.059999999999999, 15.31, 18.4, None, 24.2, 20.29, 11.79, 12.99, 14.12, 14.835, 22.185000000000002, 13.629999999999999, 24.53, 14.759999999999998, 10.81, 15.48, 17.384999999999998, 28.475, 8.685, 8.185, 26.54, 11.045, 13.125, 13.335, 14.719999999999999], 
'Humidity': [87, 95, 89, 92, 85, 77, 62, 54, 74, 76, 59, 83, 54, 86, 72, 88, 57, 72, 68, 49, 60, 80, 87, 74, 67, 60, 78, 79, 76, 49, 59, 52, 52, 48, 59, 51, 72, 60, 53, 26, 21, 17, 19, 53, 47, 61, 52, 14, 43, 49, 61, 63, 69, 50, 66, 62, 56, 76, 81, 44, 57, 52, 74, 54, 69, 37, 36, 29, 63, 76, 77, 22, 76, 54, 76, 39], 
'Wind Speed': [5.688178273167369, 4.256080887616321, 5.5166271309313615, 3.022340928974787, 4.660629937646809, 1.5463835202417877, 4.1682743104138495, 6.356576870025717, 4.814031561738116, 5.139042687369761, 3.149385121996872,
4.1126756378933695, 2.4173575636787827, 8.136961927757893, 10.003034581794322, 2.3763161367533607, 5.760150561677139, 9.660104657856783, 6.650408826464116, 5.233679195657361, 2.8188047800843075, 3.931978256623983, 4.151374897505236, 4.116903998244916, 6.23950461746865, 4.277151654036428, 3.868246507394152, 5.9501053168827385, 6.7267319944245605, 5.447050252156739, 6.852426113001406, 3.300145493130783, 7.208142457117103, 9.398261177388054, 7.681313746920651, 6.337541427696917, 8.277416391776027, 6.457457070733583, 8.994608267284393, 5.04530362215064,
5.393356180869058, 4.628981630345449, 7.045320790450435, 4.1918066491688535, 6.181467470025717, 3.165243194331769, 4.551513895071449, 7.1944691052069265, 5.664886543100294, 2.915715943161272, 3.850894390604205, 3.528815773567698, 4.66325817227392, 12.184528963464038, 6.11, 8.108677293130784, 6.1081513090882575, 6.110308796627694, 7.436534836554522, 4.763792452079854, 8.465394535305814, 7.188174834165806, 13.22757429615048, 8.653125064171903, 9.09879333108513, 3.203600970333254, 5.856301055483974, 4.888911406747263, 9.926153456809566, 9.420959782101859, 8.425715411614837, 11.470263423783768, 6.851965021843104, 7.2287216804687295, 2.096358575847716, 8.00534817399984], 
'Region': ['New England', 'New England', 'New England', 'New England', 'New England', 'New England', 'Middle Atlantic', 'Middle Atlantic', 'Middle Atlantic', 'Middle Atlantic', 'Middle Atlantic', 'South', 'South', 'South', 'South', 'South', 'South', 'South', 'South', 'South', 'South', 'South', 'South', 'South', 'South', 'South', 'South', 'South', 'South', 'Midwest', 'Midwest', 'Midwest', 'Midwest', 'Midwest', 'Midwest', 'Midwest', 'Midwest', 'Midwest', 'Midwest', 'South West', 'South West', 'South West', 'South West', 'South West', 'South West', 'South West', 'South West', 'South West', 'South West', 'South West', 'South West', 'West', 'West', 'West', 'West', 'West', 'West', 'West', 'West', 'West', 'West', 'West', 'West', 'West', 'West', 'West', 'West', 'West', 'West', 'West', 'West', 'West', 'West', 'West', 'West', 'West']}